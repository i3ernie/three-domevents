{"version":3,"file":"DomeventDrag.amd.js","sources":["../src/domevents/DomeventDrag.es.js"],"sourcesContent":["import getRelativeMouseXY from \"../PointerTools.es.js\";\n\n\n\n/*const _onMousedown = function( event ){ console.log(\"down\");\n    if ( event.intersect.object.id === event.target.id ){\n        this._mousedownd[event.target.id] = event.target;\n    }\n}; */\n\nconst _onMousedown = function( ev ) { \n    this.stateMouse.mousedown = true;\n    console.log(\"down\", ev);\n    //this._mousedownd[ ev.target.id ] = ev.target;\n    \n};\n\nconst _onMouseupDrag = function( event ){\n\n    this.stateMouse.mousedown = false;\n\n    if ( this.stateMouse.dragging ) { \n        \n        this.stateMouse.dragging = false;\n        this._onMouseEvent( \"dragend\", event );\n\n        \n        for ( let key in this._draggingObjs ) { \n            this._notify( \"dragend\", this._draggingObjs[key], event, null );\n        }\n        \n    }\n    this._draggingObjs = {};\n    this._mousedownd = {};\n};\n\nconst _onPointermove = function( event ){ \n    if ( this.stateMouse.mousedown){ \n        if( this.stateMouse.dragging ) { \n            this._onMouseEvent('drag', event);\n        } else {\n            this.stateMouse.dragging = true;\n            this._onMouseEvent('dragstart', event);\n        }\n    }\n    return;\n};\n\n\n\nconst DomeventDrag = {\n\n    eventNames : [\n        \"drag\",\n        \"dragstart\",\n        \"dragend\"\n    ],\n\n    eventMapping : {\n        dragstart : \"onDragstart\",\n        dragend : \"onDragend\",\n        drag : \"onDrag\"\n    },\n\n    initialize : function( ){\n        let _this = this; \n        \n        this.stateMouse = this.stateMouse || {};    \n        this.stateMouse.dragging = false;\n\n        this._mousedownd = {};\n        this._draggingObjs = {};\n\n        this._$onMouseDownDrag = function(){ _onMousedown.apply( _this, arguments ); };\n        this._$onMouseUpDrag = function(){ _onMouseupDrag.apply( _this, arguments );\t};\n        this._$onPointerMoveDrag = function(){  _onPointermove.apply( _this, arguments ); };\n        \n        let addEventListener = this.addEventListener;\n        this.addEventListener = DomeventDrag.addEventListener.call(this, addEventListener );\n        let _notify = this._notify;\n        this._notify = DomeventDrag._notify.call(this, _notify );\n    },\n\n    _notify : function( _notify ){ \n\n        let ret = null;\n        let scope = this;\n\n        return function( eventName, object3d, origDomEvent, intersect, intersects ){   \n            if ( eventName === \"dragstart\" ) {\n                scope._draggingObjs[object3d.id] = object3d;\n            }\n            if ( eventName === \"dragend\" ){\n                if ( scope._draggingObjs[object3d.id] ) { \n                    delete scope._draggingObjs[object3d.id];\n                    return _notify.call(scope, eventName, object3d, origDomEvent, intersect, intersects );\n                }\n                return false;\n            }\n            \n            ret = _notify.call(scope, eventName, object3d, origDomEvent, intersect, intersects );\n\n            return ret;\n        };\n    },\n\n    addEventListener : function( addEventListener ){ \n        let scope = this;\n\n        return function( object3d, eventName, callback, opt ) { \n           \n            if ( eventName === \"drag\" ) {\n                if( !scope.hasListener(object3d, \"pointerdown\") ){\n                    scope.addEventListener( object3d, \"pointerdown\", \"pointerdown\" );\n                }\n                object3d.addEventListener(\"pointerdown\", scope._$onDragStart );\n\n                if( !scope.hasListener(object3d, \"pointermove\") ){\n                    scope.addEventListener( object3d, \"pointermove\", \"pointermove\" );\n                }\n                object3d.addEventListener(\"pointermove\", scope._$onDragging );\n            }\n\n            addEventListener.call(scope, object3d, eventName, callback, opt );\n        } \n    },\n\n    enable : function() { \n        this._domElement.addEventListener( 'pointerdown'\t, this._$onMouseDownDrag\t, false );\n        this._domElement.addEventListener( 'pointerup'\t, this._$onMouseUpDrag\t\t, false );\n        this._domElement.addEventListener( 'pointermove'\t, this._$onPointerMoveDrag\t, false );\n        \n    },\n\n    disable : function() {\n        this._domElement.removeEventListener( 'pointerdown', this._$onMouseDownDrag\t, false );\n        this._domElement.removeEventListener( 'pointerup', this._$onMouseUpDrag\t\t, false );\n        this._domElement.removeEventListener( 'pointermove', this._$onPointerMoveDrag\t, false );\n        \n    }\n};\n\n\nexport default DomeventDrag;\nexport { DomeventDrag };"],"names":[],"mappings":"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"}