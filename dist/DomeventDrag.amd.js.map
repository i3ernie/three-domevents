{"version":3,"file":"DomeventDrag.amd.js","sources":["../src/domevents/DomeventDrag.es.js"],"sourcesContent":["import getRelativeMouseXY from \"../PointerTools.es.js\";\n\n\n\n/*const _onMousedown = function( event ){ console.log(\"down\");\n    if ( event.intersect.object.id === event.target.id ){\n        this._mousedownd[event.target.id] = event.target;\n    }\n}; */\n\nconst _onMousedown = function( ev ) { \n    this.stateMouse.mousedown = true;\n    console.log(\"down\", ev);\n    //this._mousedownd[ ev.target.id ] = ev.target;\n    \n};\n\nconst _onMouseupDrag = function( event ){\n\n    if ( this.stateMouse.dragging ) { \n        \n        this.stateMouse.dragging = false;\n        this._onMouseEvent( \"dragend\", event );\n\n        \n        for ( let key in this._draggingObjs ) { \n            this._notify( \"dragend\", this._draggingObjs[key], event, null );\n        }\n        \n    }\n    this._draggingObjs = {};\n    this._mousedownd = {};\n};\n\nconst _onMousemove = function( event ){ \n    if ( this.stateMouse.mousedown && !this.stateMouse.dragging ) { \n        \n        this.stateMouse.dragging = true;\n        this._onMouseEvent('dragstart', event);\n        \n    } \n    return;\n};\n\nconst _onMouseEvent\t= function( eventName, domEvent )\n{\n    let mouseCoords = getRelativeMouseXY( domEvent );\n    this._onEvent(eventName, mouseCoords.x, mouseCoords.y, domEvent);\n};\n\n\nconst DomeventDrag = {\n\n    eventNames : [\n        \"drag\",\n        \"dragstart\",\n        \"dragend\"\n    ],\n\n    eventMapping : {\n        dragstart : \"onDragstart\",\n        dragend : \"onDragend\",\n        drag : \"onDrag\"\n    },\n\n    initialize : function( ){\n        let _this = this; \n        \n        this.stateMouse = this.stateMouse || {};    \n        this.stateMouse.dragging = false;\n\n        this._mousedownd = {};\n        this._draggingObjs = {};\n\n        this._$onMouseDownDrag = function(){ _onMousedown.apply( _this, arguments ); };\n        //this._$onDragStart\t= function(){ _onMousedown.apply( _this, arguments ); };\n        this._$onDragging\t= function(){ _onMousemove.apply(_this, arguments);\t};\n        this._$onMouseUpDrag = function(){ _onMouseupDrag.apply( _this, arguments );\t};\n        this._$onMouseMoveDrag = function(){  _onMousemove.apply( _this, arguments ); };\n        \n        let addEventListener = this.addEventListener;\n        this.addEventListener = DomeventDrag.addEventListener.call(this, addEventListener );\n        let _notify = this._notify;\n        this._notify = DomeventDrag._notify.call(this, _notify );\n    },\n\n    _notify : function( _notify ){ \n\n        let ret = null;\n\n        return function( eventName, object3d, origDomEvent, intersect ){   \n            if ( eventName === \"dragstart\" ) {\n                console.log( eventName, object3d );\n                this._draggingObjs[object3d.id] = object3d;\n            }\n            if ( eventName === \"dragend\" ){\n                if ( this._draggingObjs[object3d.id] ) { \n                    delete this._draggingObjs[object3d.id];\n                    return _notify.call(this, eventName, object3d, origDomEvent, intersect );\n                }\n                return false;\n            }\n            ret = _notify.call(this, eventName, object3d, origDomEvent, intersect );\n            if ( this.stateMouse.mousedown && this.stateMouse.dragging && eventName === \"mousemove\" ) {\n                if ( this._draggingObjs[object3d.id] ) ret = _notify.call( this, 'drag', object3d, origDomEvent, intersect );\n            }\n            return ret;\n        };\n    },\n\n    addEventListener : function( addEventListener ){ \n        return function( object3d, eventName, callback, opt ) { \n            let scope = this;\n\n            if ( eventName === \"drag\" ) {\n                if( !this.hasListener(object3d, \"mousedown\") ){\n                    this.addEventListener( object3d, \"mousedown\", \"mousedown\" );\n                }\n                object3d.addEventListener(\"mousedown\", scope._$onDragStart );\n\n                if( !this.hasListener(object3d, \"mousemove\") ){\n                    this.addEventListener( object3d, \"mousemove\", \"mousemove\" );\n                }\n                object3d.addEventListener(\"mousemove\", scope._$onDragging );\n            }\n\n            addEventListener.call(scope, object3d, eventName, callback, opt );\n        } \n    },\n\n    enable : function() { \n        this._domElement.addEventListener( 'mousedown'\t, this._$onMouseDownDrag\t, false );\n        this._domElement.addEventListener( 'mouseup'\t, this._$onMouseUpDrag\t\t, false );\n        this._domElement.addEventListener( 'mousemove'\t, this._$onMouseMoveDrag\t, false );\n        \n    },\n\n    disable : function() {\n        this._domElement.removeEventListener( 'mousedown', this._$onMouseDownDrag\t, false );\n        this._domElement.removeEventListener( 'mouseup', this._$onMouseUpDrag\t\t, false );\n        this._domElement.removeEventListener( 'mousemove', this._$onMouseMoveDrag\t, false );\n        \n    }\n};\n\n\nexport default DomeventDrag;\nexport { DomeventDrag };"],"names":["const","let"],"mappings":"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"}