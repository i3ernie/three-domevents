{"version":3,"file":"DomeventDrag.amd.js","sources":["../src/domevents/DomeventDrag.es.js"],"sourcesContent":["import getRelativeMouseXY from \"../PointerTools.es.js\";\n\n\n\n/*const _onMousedown = function( event ){ console.log(\"down\");\n    if ( event.intersect.object.id === event.target.id ){\n        this._mousedownd[event.target.id] = event.target;\n    }\n}; */\n\nconst _onMousedown = function( ev ) { \n    this.stateMouse.mousedown = true;\n    console.log(\"down\", ev);\n    //this._mousedownd[ ev.target.id ] = ev.target;\n    \n};\n\nconst _onMouseupDrag = function( event ){\n\n    this.stateMouse.mousedown = false;\n\n    if ( this.stateMouse.dragging ) { \n        \n        this.stateMouse.dragging = false;\n        this._onMouseEvent( \"dragend\", event );\n\n        \n        for ( let key in this._draggingObjs ) { \n            this._notify( \"dragend\", this._draggingObjs[key], event, null );\n        }\n        \n    }\n    this._draggingObjs = {};\n    this._mousedownd = {};\n};\n\nconst _onPointermove = function( event ){ \n    if ( this.stateMouse.mousedown){ \n        if( this.stateMouse.dragging ) { \n            this._onMouseEvent('drag', event);\n        } else {\n            this.stateMouse.dragging = true;\n            this._onMouseEvent('dragstart', event);\n        }\n    }\n    return;\n};\n\n\n\nconst DomeventDrag = {\n\n    eventNames : [\n        \"drag\",\n        \"dragstart\",\n        \"dragend\"\n    ],\n\n    eventMapping : {\n        dragstart : \"onDragstart\",\n        dragend : \"onDragend\",\n        drag : \"onDrag\"\n    },\n\n    initialize : function( ){\n        let _this = this; \n        \n        this.stateMouse = this.stateMouse || {};    \n        this.stateMouse.dragging = false;\n\n        this._mousedownd = {};\n        this._draggingObjs = {};\n\n        this._$onMouseDownDrag = function(){ _onMousedown.apply( _this, arguments ); };\n        this._$onMouseUpDrag = function(){ _onMouseupDrag.apply( _this, arguments );\t};\n        this._$onPointerMoveDrag = function(){  _onPointermove.apply( _this, arguments ); };\n        \n        let addEventListener = this.addEventListener;\n        this.addEventListener = DomeventDrag.addEventListener.call(this, addEventListener );\n        let _notify = this._notify;\n        this._notify = DomeventDrag._notify.call(this, _notify );\n    },\n\n    _notify : function( _notify ){ \n\n        let ret = null;\n        let scope = this;\n\n        return function( eventName, object3d, origDomEvent, intersect ){   \n            if ( eventName === \"dragstart\" ) {\n                scope._draggingObjs[object3d.id] = object3d;\n            }\n            if ( eventName === \"dragend\" ){\n                if ( scope._draggingObjs[object3d.id] ) { \n                    delete scope._draggingObjs[object3d.id];\n                    return _notify.call(scope, eventName, object3d, origDomEvent, intersect );\n                }\n                return false;\n            }\n            \n            ret = _notify.call(scope, eventName, object3d, origDomEvent, intersect );\n\n            return ret;\n        };\n    },\n\n    addEventListener : function( addEventListener ){ \n        let scope = this;\n\n        return function( object3d, eventName, callback, opt ) { \n           \n            if ( eventName === \"drag\" ) {\n                if( !scope.hasListener(object3d, \"pointerdown\") ){\n                    scope.addEventListener( object3d, \"pointerdown\", \"pointerdown\" );\n                }\n                object3d.addEventListener(\"pointerdown\", scope._$onDragStart );\n\n                if( !scope.hasListener(object3d, \"pointermove\") ){\n                    scope.addEventListener( object3d, \"pointermove\", \"pointermove\" );\n                }\n                object3d.addEventListener(\"pointermove\", scope._$onDragging );\n            }\n\n            addEventListener.call(scope, object3d, eventName, callback, opt );\n        } \n    },\n\n    enable : function() { \n        this._domElement.addEventListener( 'pointerdown'\t, this._$onMouseDownDrag\t, false );\n        this._domElement.addEventListener( 'pointerup'\t, this._$onMouseUpDrag\t\t, false );\n        this._domElement.addEventListener( 'pointermove'\t, this._$onPointerMoveDrag\t, false );\n        \n    },\n\n    disable : function() {\n        this._domElement.removeEventListener( 'pointerdown', this._$onMouseDownDrag\t, false );\n        this._domElement.removeEventListener( 'pointerup', this._$onMouseUpDrag\t\t, false );\n        this._domElement.removeEventListener( 'pointermove', this._$onPointerMoveDrag\t, false );\n        \n    }\n};\n\n\nexport default DomeventDrag;\nexport { DomeventDrag };"],"names":[],"mappings":";;IAIA;IACA;IACA;IACA;IACA;AACA;IACA,MAAM,YAAY,GAAG,UAAU,EAAE,GAAG;IACpC,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC;IACrC,IAAI,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;IAC5B;IACA;IACA,CAAC,CAAC;AACF;IACA,MAAM,cAAc,GAAG,UAAU,KAAK,EAAE;AACxC;IACA,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,KAAK,CAAC;AACtC;IACA,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG;IACpC;IACA,QAAQ,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,KAAK,CAAC;IACzC,QAAQ,IAAI,CAAC,aAAa,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;AAC/C;IACA;IACA,QAAQ,MAAM,IAAI,GAAG,IAAI,IAAI,CAAC,aAAa,GAAG;IAC9C,YAAY,IAAI,CAAC,OAAO,EAAE,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;IAC5E,SAAS;IACT;IACA,KAAK;IACL,IAAI,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;IAC5B,IAAI,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;IAC1B,CAAC,CAAC;AACF;IACA,MAAM,cAAc,GAAG,UAAU,KAAK,EAAE;IACxC,IAAI,KAAK,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC;IACnC,QAAQ,IAAI,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG;IACvC,YAAY,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;IAC9C,SAAS,MAAM;IACf,YAAY,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;IAC5C,YAAY,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,KAAK,CAAC,CAAC;IACnD,SAAS;IACT,KAAK;IACL,IAAI,OAAO;IACX,CAAC,CAAC;AACF;AACA;AACA;UACM,YAAY,GAAG;AACrB;IACA,IAAI,UAAU,GAAG;IACjB,QAAQ,MAAM;IACd,QAAQ,WAAW;IACnB,QAAQ,SAAS;IACjB,KAAK;AACL;IACA,IAAI,YAAY,GAAG;IACnB,QAAQ,SAAS,GAAG,aAAa;IACjC,QAAQ,OAAO,GAAG,WAAW;IAC7B,QAAQ,IAAI,GAAG,QAAQ;IACvB,KAAK;AACL;IACA,IAAI,UAAU,GAAG,WAAW;IAC5B,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;IACzB;IACA,QAAQ,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,IAAI,EAAE,CAAC;IAChD,QAAQ,IAAI,CAAC,UAAU,CAAC,QAAQ,GAAG,KAAK,CAAC;AACzC;IACA,QAAQ,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;IAC9B,QAAQ,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;AAChC;IACA,QAAQ,IAAI,CAAC,iBAAiB,GAAG,UAAU,EAAE,YAAY,CAAC,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,EAAE,CAAC;IACvF,QAAQ,IAAI,CAAC,eAAe,GAAG,UAAU,EAAE,cAAc,CAAC,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,EAAE,CAAC;IACvF,QAAQ,IAAI,CAAC,mBAAmB,GAAG,UAAU,GAAG,cAAc,CAAC,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,EAAE,CAAC;IAC5F;IACA,QAAQ,IAAI,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC;IACrD,QAAQ,IAAI,CAAC,gBAAgB,GAAG,YAAY,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,EAAE,gBAAgB,EAAE,CAAC;IAC5F,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;IACnC,QAAQ,IAAI,CAAC,OAAO,GAAG,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC;IACjE,KAAK;AACL;IACA,IAAI,OAAO,GAAG,UAAU,OAAO,EAAE;AACjC;IACA,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC;IACvB,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;AACzB;IACA,QAAQ,OAAO,UAAU,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAE,SAAS,EAAE;IACvE,YAAY,KAAK,SAAS,KAAK,WAAW,GAAG;IAC7C,gBAAgB,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC;IAC5D,aAAa;IACb,YAAY,KAAK,SAAS,KAAK,SAAS,EAAE;IAC1C,gBAAgB,KAAK,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG;IACxD,oBAAoB,OAAO,KAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;IAC5D,oBAAoB,OAAO,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC;IAC9F,iBAAiB;IACjB,gBAAgB,OAAO,KAAK,CAAC;IAC7B,aAAa;IACb;IACA,YAAY,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,YAAY,EAAE,SAAS,EAAE,CAAC;AACrF;IACA,YAAY,OAAO,GAAG,CAAC;IACvB,SAAS,CAAC;IACV,KAAK;AACL;IACA,IAAI,gBAAgB,GAAG,UAAU,gBAAgB,EAAE;IACnD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;AACzB;IACA,QAAQ,OAAO,UAAU,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,GAAG;IAC9D;IACA,YAAY,KAAK,SAAS,KAAK,MAAM,GAAG;IACxC,gBAAgB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,QAAQ,EAAE,aAAa,CAAC,EAAE;IACjE,oBAAoB,KAAK,CAAC,gBAAgB,EAAE,QAAQ,EAAE,aAAa,EAAE,aAAa,EAAE,CAAC;IACrF,iBAAiB;IACjB,gBAAgB,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,CAAC,aAAa,EAAE,CAAC;AAC/E;IACA,gBAAgB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,QAAQ,EAAE,aAAa,CAAC,EAAE;IACjE,oBAAoB,KAAK,CAAC,gBAAgB,EAAE,QAAQ,EAAE,aAAa,EAAE,aAAa,EAAE,CAAC;IACrF,iBAAiB;IACjB,gBAAgB,QAAQ,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,CAAC,YAAY,EAAE,CAAC;IAC9E,aAAa;AACb;IACA,YAAY,gBAAgB,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,EAAE,CAAC;IAC9E,SAAS;IACT,KAAK;AACL;IACA,IAAI,MAAM,GAAG,WAAW;IACxB,QAAQ,IAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE,aAAa,GAAG,IAAI,CAAC,iBAAiB,GAAG,KAAK,EAAE,CAAC;IAC5F,QAAQ,IAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE,WAAW,GAAG,IAAI,CAAC,eAAe,IAAI,KAAK,EAAE,CAAC;IACzF,QAAQ,IAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE,aAAa,GAAG,IAAI,CAAC,mBAAmB,GAAG,KAAK,EAAE,CAAC;IAC9F;IACA,KAAK;AACL;IACA,IAAI,OAAO,GAAG,WAAW;IACzB,QAAQ,IAAI,CAAC,WAAW,CAAC,mBAAmB,EAAE,aAAa,EAAE,IAAI,CAAC,iBAAiB,GAAG,KAAK,EAAE,CAAC;IAC9F,QAAQ,IAAI,CAAC,WAAW,CAAC,mBAAmB,EAAE,WAAW,EAAE,IAAI,CAAC,eAAe,IAAI,KAAK,EAAE,CAAC;IAC3F,QAAQ,IAAI,CAAC,WAAW,CAAC,mBAAmB,EAAE,aAAa,EAAE,IAAI,CAAC,mBAAmB,GAAG,KAAK,EAAE,CAAC;IAChG;IACA,KAAK;IACL;;;;;;;;;;;"}