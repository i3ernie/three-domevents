{"version":3,"file":"DomeventDrag.es.js","sources":["../src/domevents/DomeventDrag.es.js"],"sourcesContent":["import getRelativeMouseXY from \"../PointerTools.es.js\";\n\n\n\n/*const _onMousedown = function( event ){ console.log(\"down\");\n    if ( event.intersect.object.id === event.target.id ){\n        this._mousedownd[event.target.id] = event.target;\n    }\n}; */\n\nconst _onMousedown = function( ev ) { \n    this.stateMouse.mousedown = true;\n    console.log(\"down\", ev);\n    //this._mousedownd[ ev.target.id ] = ev.target;\n    \n};\n\nconst _onMouseupDrag = function( event ){\n\n    if ( this.stateMouse.dragging ) { \n        \n        this.stateMouse.dragging = false;\n        this._onMouseEvent( \"dragend\", event );\n\n        \n        for ( let key in this._draggingObjs ) { \n            this._notify( \"dragend\", this._draggingObjs[key], event, null );\n        }\n        \n    }\n    this._draggingObjs = {};\n    this._mousedownd = {};\n};\n\nconst _onMousemove = function( event ){ \n    if ( this.stateMouse.mousedown && !this.stateMouse.dragging ) { \n        \n        this.stateMouse.dragging = true;\n        this._onMouseEvent('dragstart', event);\n        \n    } \n    return;\n};\n\nconst _onMouseEvent\t= function( eventName, domEvent )\n{\n    let mouseCoords = getRelativeMouseXY( domEvent );\n    this._onEvent(eventName, mouseCoords.x, mouseCoords.y, domEvent);\n};\n\n\nconst DomeventDrag = {\n\n    eventNames : [\n        \"drag\",\n        \"dragstart\",\n        \"dragend\"\n    ],\n\n    eventMapping : {\n        dragstart : \"onDragstart\",\n        dragend : \"onDragend\",\n        drag : \"onDrag\"\n    },\n\n    initialize : function( ){\n        let _this = this; \n        \n        this.stateMouse = this.stateMouse || {};    \n        this.stateMouse.dragging = false;\n\n        this._mousedownd = {};\n        this._draggingObjs = {};\n\n        this._$onMouseDownDrag = function(){ _onMousedown.apply( _this, arguments ); };\n        //this._$onDragStart\t= function(){ _onMousedown.apply( _this, arguments ); };\n        this._$onDragging\t= function(){ _onMousemove.apply(_this, arguments);\t};\n        this._$onMouseUpDrag = function(){ _onMouseupDrag.apply( _this, arguments );\t};\n        this._$onMouseMoveDrag = function(){  _onMousemove.apply( _this, arguments ); };\n        \n        let addEventListener = this.addEventListener;\n        this.addEventListener = DomeventDrag.addEventListener.call(this, addEventListener );\n        let _notify = this._notify;\n        this._notify = DomeventDrag._notify.call(this, _notify );\n    },\n\n    _notify : function( _notify ){ \n\n        let ret = null;\n        let scope = this;\n\n        return function( eventName, object3d, origDomEvent, intersect ){   \n            if ( eventName === \"dragstart\" ) {\n                console.log( eventName, object3d );\n                scope._draggingObjs[object3d.id] = object3d;\n            }\n            if ( eventName === \"dragend\" ){\n                if ( scope._draggingObjs[object3d.id] ) { \n                    delete scope._draggingObjs[object3d.id];\n                    return _notify.call(scope, eventName, object3d, origDomEvent, intersect );\n                }\n                return false;\n            }\n            if ( eventName === \"drag\"){\n                return _notify.call( scope, eventName, object3d, origDomEvent, intersect )\n            }\n            \n            ret = _notify.call(scope, eventName, object3d, origDomEvent, intersect );\n\n            if ( scope.stateMouse.mousedown && scope.stateMouse.dragging && eventName === \"mousemove\" ) {\n                if ( scope._draggingObjs[object3d.id] ) scope._notify.call( scope, 'drag', object3d, origDomEvent, intersect );\n            }\n\n            return ret;\n        };\n    },\n\n    addEventListener : function( addEventListener ){ \n        let scope = this;\n\n        return function( object3d, eventName, callback, opt ) { \n           \n            if ( eventName === \"drag\" ) {\n                if( !scope.hasListener(object3d, \"mousedown\") ){\n                    scope.addEventListener( object3d, \"mousedown\", \"mousedown\" );\n                }\n                object3d.addEventListener(\"mousedown\", scope._$onDragStart );\n\n                if( !scope.hasListener(object3d, \"mousemove\") ){\n                    scope.addEventListener( object3d, \"mousemove\", \"mousemove\" );\n                }\n                object3d.addEventListener(\"mousemove\", scope._$onDragging );\n            }\n\n            addEventListener.call(scope, object3d, eventName, callback, opt );\n        } \n    },\n\n    enable : function() { \n        this._domElement.addEventListener( 'mousedown'\t, this._$onMouseDownDrag\t, false );\n        this._domElement.addEventListener( 'mouseup'\t, this._$onMouseUpDrag\t\t, false );\n        this._domElement.addEventListener( 'mousemove'\t, this._$onMouseMoveDrag\t, false );\n        \n    },\n\n    disable : function() {\n        this._domElement.removeEventListener( 'mousedown', this._$onMouseDownDrag\t, false );\n        this._domElement.removeEventListener( 'mouseup', this._$onMouseUpDrag\t\t, false );\n        this._domElement.removeEventListener( 'mousemove', this._$onMouseMoveDrag\t, false );\n        \n    }\n};\n\n\nexport default DomeventDrag;\nexport { DomeventDrag };"],"names":["const","let"],"mappings":"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"}