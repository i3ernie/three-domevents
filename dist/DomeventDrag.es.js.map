{"version":3,"file":"DomeventDrag.es.js","sources":["../src/domevents/DomeventDrag.es.js"],"sourcesContent":["import getRelativeMouseXY from \"../PointerTools.es.js\";\n\n\n\n/*const _onMousedown = function( event ){ console.log(\"down\");\n    if ( event.intersect.object.id === event.target.id ){\n        this._mousedownd[event.target.id] = event.target;\n    }\n}; */\n\nconst _onMousedown = function( ev ) { \n    this.stateMouse.mousedown = true;\n    console.log(\"down\", ev);\n    //this._mousedownd[ ev.target.id ] = ev.target;\n    \n};\n\nconst _onMouseupDrag = function( event ){\n\n    this.stateMouse.mousedown = false;\n\n    if ( this.stateMouse.dragging ) { \n        \n        this.stateMouse.dragging = false;\n        this._onMouseEvent( \"dragend\", event );\n\n        \n        for ( let key in this._draggingObjs ) { \n            this._notify( \"dragend\", this._draggingObjs[key], event, null );\n        }\n        \n    }\n    this._draggingObjs = {};\n    this._mousedownd = {};\n};\n\nconst _onPointermove = function( event ){ \n    if ( this.stateMouse.mousedown){ \n        if( this.stateMouse.dragging ) { \n            this._onMouseEvent('drag', event);\n        } else {\n            this.stateMouse.dragging = true;\n            this._onMouseEvent('dragstart', event);\n        }\n    }\n    return;\n};\n\n\n\nconst DomeventDrag = {\n\n    eventNames : [\n        \"drag\",\n        \"dragstart\",\n        \"dragend\"\n    ],\n\n    eventMapping : {\n        dragstart : \"onDragstart\",\n        dragend : \"onDragend\",\n        drag : \"onDrag\"\n    },\n\n    initialize : function( ){\n        let _this = this; \n        \n        this.stateMouse = this.stateMouse || {};    \n        this.stateMouse.dragging = false;\n\n        this._mousedownd = {};\n        this._draggingObjs = {};\n\n        this._$onMouseDownDrag = function(){ _onMousedown.apply( _this, arguments ); };\n        this._$onMouseUpDrag = function(){ _onMouseupDrag.apply( _this, arguments );\t};\n        this._$onPointerMoveDrag = function(){  _onPointermove.apply( _this, arguments ); };\n        \n        let addEventListener = this.addEventListener;\n        this.addEventListener = DomeventDrag.addEventListener.call(this, addEventListener );\n        let _notify = this._notify;\n        this._notify = DomeventDrag._notify.call(this, _notify );\n    },\n\n    _notify : function( _notify ){ \n\n        let ret = null;\n        let scope = this;\n\n        return function( eventName, object3d, origDomEvent, intersect, intersects ){   \n            if ( eventName === \"dragstart\" ) {\n                scope._draggingObjs[object3d.id] = object3d;\n            }\n            if ( eventName === \"dragend\" ){\n                if ( scope._draggingObjs[object3d.id] ) { \n                    delete scope._draggingObjs[object3d.id];\n                    return _notify.call(scope, eventName, object3d, origDomEvent, intersect, intersects );\n                }\n                return false;\n            }\n            \n            ret = _notify.call(scope, eventName, object3d, origDomEvent, intersect, intersects );\n\n            return ret;\n        };\n    },\n\n    addEventListener : function( addEventListener ){ \n        let scope = this;\n\n        return function( object3d, eventName, callback, opt ) { \n           \n            if ( eventName === \"drag\" ) {\n                if( !scope.hasListener(object3d, \"pointerdown\") ){\n                    scope.addEventListener( object3d, \"pointerdown\", \"pointerdown\" );\n                }\n                object3d.addEventListener(\"pointerdown\", scope._$onDragStart );\n\n                if( !scope.hasListener(object3d, \"pointermove\") ){\n                    scope.addEventListener( object3d, \"pointermove\", \"pointermove\" );\n                }\n                object3d.addEventListener(\"pointermove\", scope._$onDragging );\n            }\n\n            addEventListener.call(scope, object3d, eventName, callback, opt );\n        } \n    },\n\n    enable : function() { \n        this._domElement.addEventListener( 'pointerdown'\t, this._$onMouseDownDrag\t, false );\n        this._domElement.addEventListener( 'pointerup'\t, this._$onMouseUpDrag\t\t, false );\n        this._domElement.addEventListener( 'pointermove'\t, this._$onPointerMoveDrag\t, false );\n        \n    },\n\n    disable : function() {\n        this._domElement.removeEventListener( 'pointerdown', this._$onMouseDownDrag\t, false );\n        this._domElement.removeEventListener( 'pointerup', this._$onMouseUpDrag\t\t, false );\n        this._domElement.removeEventListener( 'pointermove', this._$onPointerMoveDrag\t, false );\n        \n    }\n};\n\n\nexport default DomeventDrag;\nexport { DomeventDrag };"],"names":[],"mappings":"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"}